<section
  class="w-full bg-white rounded-lg shadow relative flex flex-col items-center overflow-hidden"
>
  <!-- Padding container for non-scrolling elements -->
  <div class="w-full p-6 flex flex-col items-center">
    <!-- Toggle for collected stickers -->
    <div class="absolute top-6 right-6 flex items-center gap-2">
      <label class="flex items-center gap-2 cursor-pointer group filter-toggle">
        <div
          class="w-4 h-4 border-2 border-gray-400 rounded flex items-center justify-center transition-all duration-200 group-hover:border-gray-500"
          [class.bg-yellow-400]="showCollectedStickers()"
          [class.border-yellow-400]="showCollectedStickers()"
        >
          <div
            class="w-2 h-2 bg-white rounded-sm transition-transform duration-200"
            [class.scale-100]="showCollectedStickers()"
            [class.scale-0]="!showCollectedStickers()"
          ></div>
        </div>
        <span
          class="text-sm text-gray-600 group-hover:text-gray-700 transition-colors duration-200"
        >
          {{ 'STICKER_ALBUM.SHOW_COLLECTED_STICKERS' | translate }}
        </span>
        <input
          type="checkbox"
          class="sr-only"
          [checked]="showCollectedStickers()"
          (change)="toggleShowCollectedStickers()"
        />
      </label>
    </div>

    <button
      class="absolute left-1 top-1/2 -translate-y-1/2 bg-yellow-300 rounded-full p-2 shadow hover:bg-yellow-400 transition-all duration-300 z-10 arrow-button"
      aria-label="STICKER_ALBUM.PREVIOUS_PAGE_ALT_TEXT"
      (click)="prevPage()"
    >
      <span class="block w-6 h-6 border-l-4 border-b-4 border-yellow-700 rotate-45"></span>
    </button>
    <button
      class="absolute right-1 top-1/2 -translate-y-1/2 bg-yellow-300 rounded-full p-2 shadow hover:bg-yellow-400 transition-all duration-300 z-10 arrow-button"
      aria-label="STICKER_ALBUM.NEXT_PAGE_ALT_TEXT"
      (click)="nextPage()"
    >
      <span class="block w-6 h-6 border-r-4 border-b-4 border-yellow-700 -rotate-45"></span>
    </button>
  </div>

  <!-- Sticker grid container - no padding, full width -->
  <div class="relative w-full overflow-hidden">
    <div
      class="flex transition-transform duration-500 ease-in-out sticker-scroll-container"
      [style.transform]="'translateX(' + -page() * 100 + '%)'"
    >
      @for (page of pages(); track $index) {
        <div class="w-full flex-shrink-0 page-container">
          <div
            class="grid grid-cols-8 grid-rows-4 gap-4 mt-2 mb-6 w-full select-none px-6 sticker-grid"
          >
            @for (checklistModel of page; track checklistModel.index) {
              <div #stickerItem [attr.data-sticker-index]="checklistModel.index">
                <mkworld-sticker
                  class="w-full h-full"
                  [checklistModel]="checklistModel"
                  (onHover)="onChecklistItemHover($event, checklistModel.description!)"
                  (onShowTooltip)="onStickerTooltip($event.instructions, $event.event)"
                  (onGoToMap)="onGoToMap($event)"
                  (onChecked)="onStickerChecked()"
                ></mkworld-sticker>
              </div>
            }
          </div>
        </div>
      }
    </div>
  </div>

  <div class="flex justify-center gap-2 mb-2">
    @for (dot of [].constructor(pageCount()); track $index) {
      <span
        class="w-3 h-3 rounded-full cursor-pointer"
        [class.bg-yellow-400]="$index === page()"
        [class.bg-gray-300]="$index !== page()"
        [class.opacity-80]="$index === page()"
        [class.opacity-50]="$index !== page()"
        (click)="goToPage($index)"
      ></span>
    }
  </div>
  <div
    class="w-full bg-gray-100 rounded px-4 py-2 text-center text-gray-700 font-medium shadow-inner task-bar-text"
    [class.fade]="!hoveredDescription()"
  >
    {{
      (hoveredDescription() ? 'STICKERS.' + hoveredDescription() : 'STICKER_ALBUM.STICKER_HOVER')
        | translate
    }}
  </div>
</section>

@if (tooltipText() && tooltipPosition()) {
  <div
    class="sticker-tooltip fixed z-50 flex flex-col items-center"
    [style.left.px]="tooltipPosition()!.x"
    [style.top.px]="tooltipPosition()!.y"
    style="transform: translate(-50%, -100%); margin-top: -8px"
  >
    <!-- Tooltip content box -->
    <div class="relative w-auto bg-gray-800 text-white rounded-md shadow-lg">
      <div class="flex items-center px-4 py-2">
        <p class="pr-2 text-center">{{ 'STICKERS.' + tooltipText()! | translate }}</p>
        <button
          class="flex-shrink-0 flex justify-center items-center w-5 h-5 rounded-full text-white hover:bg-gray-700 transition-colors"
          (click)="closeTooltip()"
          aria-label="STICKER_ALBUM.CLOSE_TOOLTIP_ALT_TEXT"
        >
          <span class="text-xl leading-none -mt-[3px]">&times;</span>
        </button>
      </div>
    </div>
    <!-- Triangle -->
    <div
      class="w-0 h-0 border-l-[8px] border-l-transparent border-r-[8px] border-r-transparent border-t-[8px] border-t-gray-800"
    ></div>
  </div>
}
